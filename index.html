// Configurações e Estado
let totalXP = 0;
const signalValue = 10;
const walletAddress = "0x51D182a04a9F22FDf424Dc854cc6c7bE70259024";

// Função para formatar a data (opcional, para dar um toque profissional)
function getTimestamp() {
    const now = new Date();
    return now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
}

// Função Principal de Envio de Sinal
async function sendSignal() {
    const statusElement = document.getElementById('status-message');
    const xpElement = document.getElementById('total-xp');
    const btn = document.querySelector('.btn-signal');

    try {
        // Feedback visual de carregamento
        btn.disabled = true;
        btn.innerText = "SENDING...";
        statusElement.innerText = "Processing on ARC Testnet...";

        // Simulação de transação (Aqui podes integrar com a MetaMask no futuro)
        // Por agora, geramos um hash fictício para o link de SCAN
        const mockHash = "0x" + Math.random().toString(16).slice(2, 42);

        // Atualizar XP
        totalXP += signalValue;
        xpElement.innerText = totalXP;

        // Adicionar ao Log com limite de 3
        updateActivityLog(mockHash);

        // Sucesso
        statusElement.innerText = "Signal sent successfully!";
        statusElement.style.color = "#00f3ff";

    } catch (error) {
        statusElement.innerText = "Error sending signal. Try again.";
        statusElement.style.color = "#ff4b4b";
    } finally {
        setTimeout(() => {
            btn.disabled = false;
            btn.innerText = "SEND SIGNAL";
        }, 1000);
    }
}

// Função para atualizar o Log e manter apenas os 3 mais recentes
function updateActivityLog(hash) {
    const logList = document.getElementById('activity-log');
    
    // Criar o novo item da lista
    const newEntry = document.createElement('li');
    // Usamos o timestamp para o utilizador saber qual é o mais recente
    newEntry.innerHTML = `Signal Sent <span>[${getTimestamp()}]</span> <a href="https://explorer.arc.io/tx/${hash}" target="_blank">SCAN</a>`;
    
    // Adicionar no topo da lista
    logList.insertBefore(newEntry, logList.firstChild);

    // LÓGICA DE LIMITE: Remove o sinal mais antigo se houver mais de 3
    while (logList.children.length > 3) {
        logList.removeChild(logList.lastChild);
    }
}

// Inicialização
document.addEventListener('DOMContentLoaded', () => {
    console.log("ARC Interaction Hub Ready");
});
